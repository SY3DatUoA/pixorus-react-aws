import * as React from 'react';
import { FormField } from './FormField.mjs';
import { useAuthenticator } from '@aws-amplify/ui-react-core';

function FormFields({ includePassword, } = {}) {
    const { fields } = useAuthenticator(({ route }) => [route]);
    const { selectedAuthMethod, preferredChallenge } = useAuthenticator((context) => [context.selectedAuthMethod, context.preferredChallenge]);
    // Determine if password should be shown
    const effectiveMethod = selectedAuthMethod ?? preferredChallenge;
    const shouldRequirePassword = includePassword ?? (!effectiveMethod || effectiveMethod === 'PASSWORD');
    const formFields = React.useRef(fields
        .map((field, index) => {
        // Make password and confirm_password optional for passwordless methods
        if ((field.name === 'password' || field.name === 'confirm_password') &&
            !shouldRequirePassword) {
            return (React.createElement(FormField, { key: index, ...field, isRequired: false }));
        }
        return (React.createElement(FormField
        // use index for key, field order is static
        , { 
            // use index for key, field order is static
            key: index, ...field }));
    })
        .filter(Boolean)).current;
    return React.createElement(React.Fragment, null, formFields);
}

export { FormFields };
